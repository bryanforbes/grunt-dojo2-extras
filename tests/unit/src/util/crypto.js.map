{"version":3,"file":"crypto.js","sourceRoot":"","sources":["../../../../../tests/unit/src/util/crypto.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAAA,6CAA+C;IAC/C,2CAA6C;IAC7C,iCAAkC;IAClC,yBAAgC;IAChC,uDAAqD;IACrD,wCAA0C;IAE1C,aAAa,CAAC;QACb,IAAI,EAAE,aAAa;QAEb,eAAe;;oBACd,GAAG;;;;kCAAG,kBAAO,CAAC,WAAW,CAAC;4BACnB,qBAAM,MAAM,CAAC,eAAe,CAAC,GAAG,CAAC,EAAA;;mCAAjC,SAAiC;4BAE9C,MAAM,CAAC,MAAM,CAAC,eAAU,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;4BAC1C,MAAM,CAAC,MAAM,CAAC,eAAU,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;;;;;SAC3C;QAEK,OAAO;;oBACN,QAAQ;;;;uCAAG,cAAc;4BAChB,qBAAM,IAAI,OAAO,CAAC,UAAU,OAAO;oCACjD,IAAI,GAAG,GAAG,EAAE,CAAC;oCACb,IAAM,MAAM,GAAG,IAAI,iBAAQ,EAAE,CAAC;oCAC9B,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;oCACtB,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;oCAClB,IAAM,GAAG,GAAG,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;oCACvC,MAAM,CAAC,WAAW,CAAC,GAAG,CAAC,SAAS,EAAE,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,EAAE,CAAC;yCAChD,EAAE,CAAC,MAAM,EAAE,UAAU,KAAa;wCAClC,GAAG,IAAI,KAAK,CAAC;oCACd,CAAC,CAAC;yCACD,EAAE,CAAC,KAAK,EAAE;wCACV,OAAO,CAAC,GAAG,CAAC,CAAC;oCACd,CAAC,CAAC,CAAC;gCACL,CAAC,CAAC,EAAA;;qCAba,SAab;4BACF,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;;;;;SACrC;KACD,CAAC,CAAC","sourcesContent":["import * as registerSuite from 'intern!object';\nimport * as assert from 'intern/chai!assert';\nimport { Readable } from 'stream';\nimport { existsSync } from 'fs';\nimport { tmpFile } from '../../../_support/tmpFiles';\nimport * as crypto from 'src/util/crypto';\n\nregisterSuite({\n\tname: 'util/crypto',\n\n\tasync createDeployKey() {\n\t\tconst tmp = tmpFile('deployKey');\n\t\tconst keys = await crypto.createDeployKey(tmp);\n\n\t\tassert.isTrue(existsSync(keys.publicKey));\n\t\tassert.isTrue(existsSync(keys.privateKey));\n\t},\n\n\tasync encrypt() {\n\t\tconst expected = 'Hello World!';\n\t\tconst result = await new Promise(function (resolve) {\n\t\t\tlet out = '';\n\t\t\tconst stream = new Readable();\n\t\t\tstream.push(expected);\n\t\t\tstream.push(null);\n\t\t\tconst enc = crypto.encryptData(stream);\n\t\t\tcrypto.decryptData(enc.encrypted, enc.key, enc.iv)\n\t\t\t\t.on('data', function (chunk: string) {\n\t\t\t\t\tout += chunk;\n\t\t\t\t})\n\t\t\t\t.on('end', function () {\n\t\t\t\t\tresolve(out);\n\t\t\t\t});\n\t\t});\n\t\tassert.strictEqual(result, expected);\n\t}\n});\n"]}