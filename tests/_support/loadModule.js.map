{"version":3,"file":"loadModule.js","sourceRoot":"","sources":["../../../tests/_support/loadModule.ts"],"names":[],"mappings":";;;;;;;;;;;IAAA,iCAAmC;IAKnC,oBAAsC,GAAW,EAAE,KAAU,EAAE,aAA6B;QAA7B,8BAAA,EAAA,oBAA6B;QAC3F,OAAO,CAAC,MAAM,CAAC;YACd,aAAa,EAAE,IAAI;YACnB,kBAAkB,EAAE,KAAK;SACzB,CAAC,CAAC;QACH,OAAO,CAAC,UAAU,EAAE,CAAC;QAErB,GAAG,CAAC,CAAC,IAAM,KAAG,IAAI,KAAK,CAAC,CAAC,CAAC;YACzB,OAAO,CAAC,YAAY,CAAC,KAAG,EAAE,KAAK,CAAC,KAAG,CAAC,CAAC,CAAC;QACvC,CAAC;QAED,IAAM,MAAM,GAAG,OAAO,CAAC,WAAW,IAAI,OAAO,CAAC;QAC9C,IAAM,MAAM,GAAG,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;QAC1C,MAAM,CAAC,aAAa,IAAI,MAAM,CAAC,OAAO,GAAG,MAAM,CAAC,OAAO,GAAG,MAAM,CAAC;IAClE,CAAC;IAdD,6BAcC;IAED;QACC,OAAO,CAAC,aAAa,EAAE,CAAC;QACxB,OAAO,CAAC,OAAO,EAAE,CAAC;IACnB,CAAC;IAHD,gDAGC","sourcesContent":["import * as mockery from 'mockery';\nimport { RootRequire } from '@dojo/interfaces/loader';\n\ndeclare const require: RootRequire;\n\nexport default function loadModule<T>(mid: string, mocks: any, returnDefault: boolean = true): T {\n\tmockery.enable({\n\t\tuseCleanCache: true,\n\t\twarnOnUnregistered: false\n\t});\n\tmockery.resetCache();\n\n\tfor (const mid in mocks) {\n\t\tmockery.registerMock(mid, mocks[mid]);\n\t}\n\n\tconst loader = require.nodeRequire || require;\n\tconst module = loader(require.toUrl(mid));\n\treturn returnDefault && module.default ? module.default : module;\n}\n\nexport function cleanupModuleMocks() {\n\tmockery.deregisterAll();\n\tmockery.disable();\n}\n"]}